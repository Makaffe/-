<nz-modal [(nzVisible)]="isVisible" [nzTitle]="'问题下发'" [nzMaskClosable]="false" (nzOnCancel)="handleCancel()"
  [nzFooter]="rectifyIssueOrderFooter" [nzStyle]="{ top: '65px' }" nzWidth="900" [nzBodyStyle]="{
    'min-height': '300px',
    'overflow-x': 'hidden',
    padding: '24px 24px 0 24px'
  }">
  <form nz-form>
    <nz-form-item>
      <nz-form-label nzSpan="4">发送对象</nz-form-label>
      <nz-form-control nzSpan="20">
        <nz-table #basicTable [nzData]="listOfData" [nzShowPagination]="false" nzBordered="true"
          [nzScroll]="{ y: '100%' }">
          <thead>
            <tr>
              <th nzWidth="50px">序号</th>
              <th nzWidth="50%">整改部门</th>
              <th nzWidth="50%">整改负责人</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of basicTable.data; let number = index">
              <td>{{ number + 1 }}</td>
              <td>{{ data.rectifyDepartment}}</td>
              <td>{{ data.dutyUser }}</td>
            </tr>
          </tbody>
        </nz-table>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label nzSpan="4">OA发文模板</nz-form-label>
      <nz-form-control nzSpan="20">
        <nz-select nzAllowClear nzShowSearch nzPlaceHolder="请选择" style="width: 260px;" name="proposalTemplateId"
          [(ngModel)]="proposalTemplateId" (ngModelChange)="proposalTemplateChange($event)">
          <nz-option *ngFor="let option of proposalTemplates" [nzLabel]="option.name" [nzValue]="option.id"></nz-option>
        </nz-select>
        &nbsp;&nbsp;
        <nz-popconfirm [nzTitle]="confirmtittle" (nzOnConfirm)="confirmReference()" style="margin-top: -5px;">
          <ng-template #confirmtittle>
            引用模板建议会覆盖当前模板内容，确定要引用该模板吗？
          </ng-template>
          <button nz-button nzType="primary" nz-popconfirm
            [disabled]="!proposalTemplateId">确认引用</button>
        </nz-popconfirm>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="4" nzFor="content">模板内容</nz-form-label>
      <nz-form-control [nzSpan]="20">
        <textarea rows="5" nz-input name="content" [(ngModel)]="content"></textarea>
      </nz-form-control>
    </nz-form-item>
  </form>
  <ng-template #rectifyIssueOrderFooter>
    <button nz-button nzType="default" (click)="handleCancel()">取消</button>
    <button nz-button nzType="primary" [nzLoading]="loading" (click)="save()">
      发送
    </button>
  </ng-template>
</nz-modal>
